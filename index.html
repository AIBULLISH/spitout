<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Connect Wallet</title>
<style>
    body {
        background:#000; color:#fff; 
        display:flex; justify-content:center;
        align-items:center; height:100vh;
        font-family:Arial, sans-serif;
    }
    #wallet-button {
        background:#00ffc3; color:#000;
        padding:14px 28px; border:none;
        border-radius:12px; cursor:pointer;
        font-size:18px;
    }
    /* Popup */
    .popup {
        position:fixed; top:0; left:0; right:0; bottom:0;
        display:none; justify-content:center; align-items:center;
        background:rgba(0,0,0,0.7);
    }
    .popup-content {
        background:#111; padding:20px;
        border-radius:12px; width:280px;
        text-align:center; border:1px solid #333;
    }
    .wallet-btn {
        width:100%; padding:12px;
        margin:6px 0; border:none;
        border-radius:8px; cursor:pointer;
        background:#00ffc3; color:#000;
        font-weight:bold;
    }
</style>
</head>
<body>

<button id="wallet-button">Connect Wallet</button>

<!-- POPUP -->
<div id="wallet-popup" class="popup">
  <div class="popup-content">
    <h3>Select Wallet</h3>
    <div id="wallet-list"></div>
    <button onclick="closePopup()" style="margin-top:10px;">Cancel</button>
  </div>
</div>

<!-- Solana Web3 -->
<script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>

<script>
const WALLET_PROVIDERS = {
    phantom: {
        name: "Phantom",
        check: () => window.phantom?.solana?.isPhantom,
        get: () => window.phantom.solana
    },
    solflare: {
        name: "Solflare",
        check: () => window.solflare?.isSolflare,
        get: () => window.solflare
    },
    bitget: {
        name: "Bitget",
        check: () => window.bitkeep?.solana,
        get: () => window.bitkeep.solana
    },
    binance: {
        name: "Binance Wallet",
        check: () => window.binanceChain?.solana,
        get: () => window.binanceChain.solana
    },
    okx: {
        name: "OKX Wallet",
        check: () => window.okxwallet?.solana,
        get: () => window.okxwallet.solana
    },
    trust: {
        name: "Trust Wallet",
        check: () => window.trustwallet?.solana,
        get: () => window.trustwallet.solana
    },
    safepal: {
        name: "SafePal",
        check: () => window.safepal?.solana,
        get: () => window.safepal.solana
    },
    crypto: {
        name: "Crypto.com Wallet",
        check: () => window["defi-wallet"]?.solana,
        get: () => window["defi-wallet"].solana
    },
    bybit: {
        name: "Bybit Wallet",
        check: () => window.bybitwallet?.solana,
        get: () => window.bybitwallet.solana
    }
};

let publicKey = null;

// ---------- POPUP ----------
function showPopup() {
    const list = document.getElementById("wallet-list");
    list.innerHTML = "";

    const detected = [];
    for (const key in WALLET_PROVIDERS) {
        if (WALLET_PROVIDERS[key].check()) {
            detected.push({ key, name: WALLET_PROVIDERS[key].name });
        }
    }

    if (detected.length === 0) {
        list.innerHTML = `<p>No Solana wallet detected.</p>`;
    } else {
        detected.forEach(w => {
            const btn = document.createElement("button");
            btn.className = "wallet-btn";
            btn.textContent = w.name;
            btn.onclick = () => connectWallet(w.key);
            list.appendChild(btn);
        });
    }

    document.getElementById("wallet-popup").style.display = "flex";
}

function closePopup() {
    document.getElementById("wallet-popup").style.display = "none";
}

// ---------- CONNECT ----------
async function connectWallet(key) {
    const provider = WALLET_PROVIDERS[key].get();
    if (!provider) return alert("Wallet not found");

    await provider.connect();
    publicKey = provider.publicKey;

    document.getElementById("wallet-button").textContent =
        "Connected: " + publicKey.toString().slice(0,4) + "..." + publicKey.toString().slice(-4);

    closePopup();
}

// ---------- BUTTON CLICK ----------
document.getElementById("wallet-button").onclick = showPopup;
</script>

</body>
</html>
